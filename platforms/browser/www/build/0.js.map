{"version":3,"sources":["../../src/pages/studentenquiry-confirm/studentenquiry-confirm.module.ts","../../src/pages/studentenquiry-confirm/studentenquiry-confirm.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { StudentEnquiryConfirmPage } from './studentenquiry-confirm';\n\n@NgModule({\n  declarations: [\n    StudentEnquiryConfirmPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(StudentEnquiryConfirmPage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    StudentEnquiryConfirmPage\n  ]\n})\nexport class StudentEnquiryConfirmPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/studentenquiry-confirm/studentenquiry-confirm.module.ts","import { Component, ViewChild, ElementRef } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Camera } from '@ionic-native/camera';\nimport { IonicPage, NavController, ViewController, ToastController, Form, NavParams } from 'ionic-angular';\nimport * as _ from 'lodash';\nimport { Storage } from '@ionic/storage';\nimport { Programs, Center, Instructor, Students } from '../../providers';\n\n@IonicPage()\n@Component({\n  selector: 'studentenquiry-confirm',\n  templateUrl: 'studentenquiry-confirm.html'\n})\n\nexport class StudentEnquiryConfirmPage {\n\n  form;\n  isReadyToSave: Boolean = false;\n  branches;\n  states;\n  programmes;\n  user;\n  districts;\n  areas;\n  allStudents;\n  isStateDisabled: Boolean = false;\n  isDistrictDisabled: Boolean = false;\n  isAreaDisabled: Boolean = false;\n  counter: Number = 0;\n\n  studentCenterState = '';\n  studentProgram = '';\n\n  constructor(\n    public navCtrl: NavController,\n    public viewCtrl: ViewController,\n    formBuilder: FormBuilder,\n    public camera: Camera,\n    public programs: Programs,\n    public toastCtrl: ToastController,\n    public center: Center,\n    public program: Programs,\n    public element: ElementRef,\n    public storage: Storage,\n    public instructor: Instructor,\n    public students: Students,\n    public navParams: NavParams\n  ) {\n    let student = navParams.get('student');\n    this.form = formBuilder.group({\n      registration_fee: [0, Validators.compose([Validators.required, Validators.pattern('[0-9]*')])],\n      kit_fee: [0, Validators.compose([Validators.required, Validators.pattern('[0-9]*')])],\n      extra_fee: [0, Validators.compose([Validators.required, Validators.pattern('[0-9]*')])],\n      discount: [0, Validators.compose([Validators.required, Validators.pattern('[0-9]*')])],\n      total_amount: [0, Validators.compose([Validators.required, Validators.pattern('[0-9]*')])],\n      kit_no: ['', Validators.compose([Validators.required])],\n      course_instructor: ['', Validators.compose([Validators.required])],      \n    });\n\n    // Watch the form for changes, and\n    this.form.valueChanges.subscribe((v) => {\n      this.isReadyToSave = this.form.valid;\n    });\n\n    this.center.query().subscribe((res: any) => {\n      this.branches = res;\n      this.states = _.filter(res, function (item) {\n        return (item.center_type == 'state')\n      });\n      this.onStateChange(this.form.controls['state'].value);\n      this.onDistrictChange(this.form.controls['district'].value);\n    }, err => {\n      console.error('ERROR', err);\n    });\n\n    this.program.query().subscribe((res: any) => {\n      this.programmes = res;\n    }, err => {\n      console.error('ERROR', err);\n    });\n\n    this.storage.get('user').then((value) => {\n      this.user = value;\n      this.form.controls['enquiry_by'].setValue(this.user._id);\n      if (this.user.role == 'master') {\n        this.isStateDisabled = true;\n        this.form.controls['state'].setValue(this.user.user_state);\n        this.districts = _.filter(this.branches, function (item) {\n          return (item.center_type == 'district' && item.center_parent == this.user.user_state)\n        });\n        this.areas = _.filter(this.branches, function (item) {\n          return (item.center_type == 'unit' && item.center_parent == this.user.user_state)\n        });\n      } else if (this.user.role == 'district') {\n        this.isStateDisabled = true;\n        this.isDistrictDisabled = true;\n        this.form.controls['state'].setValue(this.user.user_state);\n        this.form.controls['district'].setValue(this.user.user_district);\n        this.areas = _.filter(this.branches, function (item) {\n          return (item.center_type == 'unit' && item.center_parent == this.user.user_district)\n        });\n      } else if (this.user.role == 'unit') {\n        this.isStateDisabled = true;\n        this.isDistrictDisabled = true;\n        this.isAreaDisabled = true;\n        this.form.controls['state'].setValue(this.user.user_state);\n        this.form.controls['district'].setValue(this.user.user_district);\n        this.form.controls['area'].setValue(this.user.user_center);\n      }\n    });\n\n    this.students.query().subscribe((res: any) => {\n      this.allStudents = res;\n    }, err => {\n      console.error('ERROR', err);\n    });\n\n  }\n\n  ionViewDidLoad() {\n\n  }\n\n  cancel() {\n    this.viewCtrl.dismiss();\n  }\n\n  onStateChange(ev) {\n    this.districts = _.filter(this.branches, function (item) {\n      return (item.center_type == 'district' && item.center_parent == ev)\n    });\n    this.areas = _.filter(this.branches, function (item) {\n      return (item.center_type == 'unit' && item.center_parent == ev)\n    });\n  }\n\n  onDistrictChange(ev) {\n    this.areas = _.filter(this.branches, function (item) {\n      return (item.center_type == 'unit' && item.center_parent == ev)\n    });\n  }\n\n  resize = (): void => {\n    const ta = this.element.nativeElement.querySelector(\"textarea\");\n    if (ta !== undefined && ta !== null) {\n      ta.style.overflow = \"hidden\";\n      ta.style.height = \"auto\";\n      ta.style.height = ta.scrollHeight + \"px\";\n    }\n  }\n\n  save() {\n    this.students.update(this.form.value).subscribe((resp) => {\n      this.viewCtrl.dismiss();\n    }, (err) => {\n      let toast = this.toastCtrl.create({\n        message: \"Error in updating the Student Enquiry. Please try again.\",\n        duration: 3000,\n        position: 'top'\n      });\n      toast.present();\n    });\n  }\n\n  onPhoneOrEmailChange(ev) {\n    let inst = _.filter(this.allStudents, function (item) {\n      if(item.whatsapp_no != undefined && item.whatsapp_no != '' && item.whatsapp_no == ev.value) {\n        return true;\n      }\n      return (item.mobile_no == ev.value || item.email_id == ev.value)\n    });\n    this.counter = inst.length;\n  }\n\n  findCenterState(ev) {\n\n  }\n\n  findProgram(ev) {\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/studentenquiry-confirm/studentenquiry-confirm.ts"],"sourceRoot":""}